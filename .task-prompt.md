# Task: Create a Dedicated `IdentifierLoader` for Endpoint Data

## Objective
To better separate concerns, extract the logic for loading identifiers from data endpoints into a new, dedicated `IdentifierLoader` class. This will decouple the `MappingExecutor` from the specifics of data loading.

## Current Implementation
The `MappingExecutor` has a public method `load_endpoint_identifiers` that contains logic to connect to a database, query an endpoint table, and return a list of identifiers. 

## Refactoring Steps

1.  **Create the `IdentifierLoader` Class:**
    *   Create a new file: `biomapper/core/engine_components/identifier_loader.py`.
    *   Define an `IdentifierLoader` class.
    *   The `__init__` method should accept a `session_manager` instance to handle database connections.
    *   Move the `load_endpoint_identifiers` method from `MappingExecutor` into the `IdentifierLoader` class. The method signature should be similar.

2.  **Update `MappingExecutor`:**
    *   In `biomapper/core/mapping_executor.py`, remove the `load_endpoint_identifiers` method.
    *   In `MappingExecutor.__init__`, instantiate the `IdentifierLoader`:
        ```python
        # Assuming self.session_manager is already created
        self.identifier_loader = IdentifierLoader(session_manager=self.session_manager)
        ```
    *   Create a new public method `load_endpoint_identifiers` on `MappingExecutor` that simply acts as a pass-through to the `IdentifierLoader` instance:
        ```python
        def load_endpoint_identifiers(self, endpoint_name: str, identifier_column: Optional[str] = None) -> List[str]:
            return self.identifier_loader.load_endpoint_identifiers(endpoint_name, identifier_column)
        ```
    *   Add the necessary import: `from .engine_components.identifier_loader import IdentifierLoader`.
# Task: Extract Strategy Configuration Loading into a `ConfigLoader` Component

## Objective
To improve the modularity of the `MappingExecutor`, extract the logic for loading and parsing mapping strategy YAML files into a dedicated `ConfigLoader` class. This will centralize configuration management and simplify the executor.

## Current Implementation
The `MappingExecutor` currently has a method `get_strategy` that reads a YAML file, parses it, and returns the strategy configuration. This logic is directly embedded within the executor.

## Refactoring Steps

1.  **Create the `ConfigLoader` Class:**
    *   Create a new file: `biomapper/core/engine_components/config_loader.py`.
    *   Define a `ConfigLoader` class in this file.
    *   Move the logic from `MappingExecutor.get_strategy` into a new method within `ConfigLoader`, for example, `load_strategy(self, strategy_name: str, strategies_config_path: str) -> dict`.
    *   The `ConfigLoader` should handle file reading, YAML parsing, and basic validation.

2.  **Update `MappingExecutor`:**
    *   In `biomapper/core/mapping_executor.py`, remove the `get_strategy` method.
    *   In the `MappingExecutor.__init__` method, create an instance of the new `ConfigLoader`:
        ```python
        self.config_loader = ConfigLoader()
        ```
    *   In the `execute_strategy` method, replace the call to `self.get_strategy(...)` with `self.config_loader.load_strategy(...)`.
    *   Add the required import: `from .engine_components.config_loader import ConfigLoader`.

## Acceptance Criteria
*   An `IdentifierLoader` class is implemented in `biomapper/core/engine_components/identifier_loader.py`.
*   The core logic of `load_endpoint_identifiers` is moved out of `MappingExecutor`.
*   `MappingExecutor` delegates the call to its `IdentifierLoader` instance.
*   The ability to load identifiers from an endpoint remains fully functional.
## Acceptance Criteria
*   The `ConfigLoader` class is implemented in `biomapper/core/engine_components/config_loader.py`.
*   The `get_strategy` method is removed from `MappingExecutor`.
*   `MappingExecutor` uses an instance of `ConfigLoader` to load strategy configurations.
*   The application's functionality remains unchanged.
