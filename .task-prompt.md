# Task: Fix Failing Cache-Related Tests in `test_mapping_executor.py`

## Task Objective

Your task is to fix two failing tests in `/home/ubuntu/biomapper/tests/core/test_mapping_executor.py`: `test_check_cache_unexpected_error` and `test_cache_results_db_error_during_commit`. The goal is to ensure these tests pass successfully when running `poetry run pytest /home/ubuntu/biomapper/tests/core/test_mapping_executor.py`.

## Prerequisites

-   You have access to the `biomapper` codebase at `/home/ubuntu/biomapper/`.
-   Poetry environment is set up and dependencies are installed.

## Input Context

-   **Failing Test File:** `/home/ubuntu/biomapper/tests/core/test_mapping_executor.py`
-   **File Under Test:** `/home/ubuntu/biomapper/biomapper/core/mapping_executor.py`
-   **Relevant Component:** `biomapper.core.engine_components.cache_manager.CacheManager`
-   **Pytest Output Snippet:**

    ```
    FAILED tests/core/test_mapping_executor.py::test_check_cache_unexpected_error - TypeError: CacheError.__init__() missing 1 requir...
    FAILED tests/core/test_mapping_executor.py::test_cache_results_db_error_during_commit - AttributeError: 'CacheManager' object has no attr...
    ```

-   **Failing Test Code:**

    -   `test_check_cache_unexpected_error` (starts line 944)
    -   `test_cache_results_db_error_during_commit` (starts line 982)

## Expected Outputs

-   Modified `/home/ubuntu/biomapper/tests/core/test_mapping_executor.py` and potentially `/home/ubuntu/biomapper/biomapper/core/engine_components/cache_manager.py` or `/home/ubuntu/biomapper/biomapper/core/exceptions.py` to make the tests pass.
-   The two specified tests should run without errors.

## Success Criteria

-   Running the command `poetry run pytest /home/ubuntu/biomapper/tests/core/test_mapping_executor.py` shows that `test_check_cache_unexpected_error` and `test_cache_results_db_error_during_commit` now pass. Other test results should remain unaffected.

## Error Recovery Instructions

-   If the fix requires changes to other parts of the caching logic, analyze the dependencies and document the required changes. If the changes are extensive, report back with a plan before implementing.

## Environment Requirements

-   A working `poetry` environment for the `biomapper` project.
-   Access to the project files.

## Task Decomposition

1.  **Analyze `test_check_cache_unexpected_error`:**
    -   Examine the `TypeError`. It seems the `CacheError` exception is not being instantiated correctly in the test or the `CacheManager`.
    -   Review the `CacheError` class definition in `/home/ubuntu/biomapper/biomapper/core/exceptions.py` to understand its `__init__` signature.
    -   Correct the instantiation of `CacheError` in the test or the code it's testing.

2.  **Analyze `test_cache_results_db_error_during_commit`:**
    -   Examine the `AttributeError`. The test is trying to access an attribute that does not exist on the `CacheManager` object.
    -   Review the `CacheManager` implementation to understand its available methods and attributes.
    -   Modify the test to use the correct methods/attributes of the `CacheManager`.

3.  **Validate Fixes:**
    -   Run `poetry run pytest /home/ubuntu/biomapper/tests/core/test_mapping_executor.py` and confirm the two tests pass.

## Validation Checkpoints

-   After fixing each test, run it individually to ensure it passes.
-   Before finishing, run the full test suite for `test_mapping_executor.py` to ensure no regressions were introduced.

## Source Prompt Reference

-   `/home/ubuntu/biomapper/roadmap/_active_prompts/2025-06-23-220824-fix-cache-tests.md`

## Context from Previous Attempts

-   This is the first attempt to fix these specific test failures.
