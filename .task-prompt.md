<<<<<<< HEAD
<<<<<<< HEAD
# Task: Refactor Configuration with Pydantic-Settings

**Source Prompt Reference:** Orchestrator-generated task to improve configuration management.

## 1. Task Objective

To refactor the API's configuration management to use the `pydantic-settings` library. This will replace the manual environment variable loading (`load_dotenv`, `os.getenv`) with a more robust, declarative, and type-safe approach.
=======
# Task: Implement Structured Logging

**Source Prompt Reference:** Orchestrator-generated task to improve service observability.

## 1. Task Objective

To replace the default FastAPI/Uvicorn logging with a structured, JSON-based logging format. This will make logs easier to parse, search, and analyze, which is critical for a production service.
>>>>>>> task/implement-structured-logging-20250624-193334

## 2. Service Architecture Context

- **Primary Service:** `biomapper-api`
<<<<<<< HEAD
- **Files to Modify:**
    - `/home/ubuntu/biomapper/biomapper-api/app/core/config.py`
    - `/home/ubuntu/biomapper/biomapper-api/pyproject.toml` (to add the new dependency)

## 3. Task Decomposition

1.  **Add Dependency:** Add `pydantic-settings` to the `dependencies` section of the `pyproject.toml` file.
2.  **Refactor `Settings` Class:**
    *   In `config.py`, change the `Settings` class to inherit from `pydantic_settings.BaseSettings` instead of `pydantic.BaseModel`.
    *   Remove the manual `load_dotenv()` call.
    *   Remove the manual `os.getenv()` calls for individual settings. `pydantic-settings` handles this automatically by matching field names to environment variable names (case-insensitively).
    *   Add a `model_config` inner class to specify the `.env` file path and other settings:
        ```python
        from pydantic_settings import BaseSettings, SettingsConfigDict

        class Settings(BaseSettings):
            PROJECT_NAME: str = "Biomapper API"
            # ... other fields

            model_config = SettingsConfigDict(env_file=".env", env_file_encoding='utf-8')
        ```
3.  **Verify Functionality:** Ensure that all settings, including the `Path` objects and the dynamic `MAX_UPLOAD_SIZE`, are still configured correctly.

## 4. Implementation Requirements

- The refactored `Settings` class should be cleaner and no longer contain manual environment variable loading logic.
- The application must behave identically to before the refactor.
- Ensure the `STRATEGIES_DIR` setting added previously is preserved.

## 5. Success Criteria and Validation

- The two specified files are modified correctly.
- The API starts up without any configuration-related errors.
- The settings are still correctly loaded from environment variables or the `.env` file.

## 6. Feedback Requirements

Create a detailed Markdown feedback file at:
`[PROJECT_ROOT]/roadmap/_active_prompts/feedback/YYYY-MM-DD-HHMMSS-feedback-08-advanced-configuration.md`

Include:
-   **Execution Status:** [COMPLETE_SUCCESS | PARTIAL_SUCCESS | FAILED]
-   **Links to Artifacts:** Links to the modified files.
-   **Summary of Changes:** A brief before-and-after comparison of the `Settings` class to highlight the improvements.
=======
# Task: Develop Python SDK for biomapper-api

**Source Prompt Reference:** Orchestrator-generated task to improve API usability.

## 1. Task Objective

To create a simple, installable Python client SDK for the `biomapper-api`. This will abstract away the details of HTTP requests and provide a clean, programmatic interface for other services or scripts to interact with the API.

## 2. Service Architecture Context

- **Primary Service:** This is a new, standalone package.
- **Files to Create:**
    - `/home/ubuntu/biomapper/biomapper_client/` (new directory)
    - `/home/ubuntu/biomapper/biomapper_client/pyproject.toml`
    - `/home/ubuntu/biomapper/biomapper_client/biomapper_client/` (new package directory)
    - `/home/ubuntu/biomapper/biomapper_client/biomapper_client/client.py`
    - `/home/ubuntu/biomapper/biomapper_client/README.md`

## 3. Task Decomposition

1.  **Set up Package Structure:** Create the directory and file structure outlined above.
2.  **Create `pyproject.toml`:** Define the package metadata (name, version, author) and its dependencies, which should include `httpx` and `pydantic`.
3.  **Implement `BiomapperClient` Class:**
    *   In `client.py`, create a class named `BiomapperClient`.
    *   The `__init__` method should accept an optional `base_url` (defaulting to `http://localhost:8000`) and initialize an `httpx.AsyncClient`.
    *   Implement an `async def execute_strategy(self, strategy_name: str, context: dict) -> dict:` method.
    *   This method should handle making the `POST` request to `/api/strategies/{strategy_name}/execute`.
    *   It should handle JSON serialization of the request body and deserialization of the response.
    *   It should raise an exception if the API returns a non-200 status code.
4.  **Write `README.md`:** Create a simple README file with installation instructions (`pip install .`) and a basic usage example showing how to instantiate the client and call `execute_strategy`.

## 4. Implementation Requirements

- The client must be fully asynchronous.
- The client should manage the lifecycle of the `httpx.AsyncClient` correctly (e.g., using `async with`).
- Provide clear error handling for network issues or API errors.

## 5. Success Criteria and Validation

- The `biomapper_client` directory and its contents are created.
- The package can be installed locally using `pip`.
- A separate script can import the `BiomapperClient` and successfully call the API (once the API is ready).

## 6. Feedback Requirements

Create a detailed Markdown feedback file at:
`[PROJECT_ROOT]/roadmap/_active_prompts/feedback/YYYY-MM-DD-HHMMSS-feedback-04-develop-python-sdk.md`

Include:
-   **Execution Status:** [COMPLETE_SUCCESS | PARTIAL_SUCCESS | FAILED]
-   **Links to Artifacts:** Links to the new files created.
-   **Summary of Changes:** A description of the client's features and a code snippet showing how to use it.
>>>>>>> task/develop-python-sdk-20250624-193327
=======
- **Files to Create:** `/home/ubuntu/biomapper/biomapper-api/app/core/logging_config.py`
- **Files to Modify:** `/home/ubuntu/biomapper/biomapper-api/app/main.py`
- **Dependencies:** This task may require adding a new dependency like `structlog`.

## 3. Task Decomposition

1.  **Add Dependency:** If using a library like `structlog`, add it to the project's `pyproject.toml`.
2.  **Create Logging Configuration:**
    *   In the new `logging_config.py` file, create a dictionary that defines the logging configuration for Python's built-in `logging` module.
    *   Configure it to use a JSON formatter. The log records should include a timestamp, log level, message, and other relevant context.
    *   Ensure Uvicorn's access logs are also captured and formatted as JSON.
3.  **Apply Configuration:**
    *   In `main.py`, import `logging.config`.
    *   Call `logging.config.dictConfig()` with your configuration dictionary before the `FastAPI` app is instantiated.
4.  **Test Logging:**
    *   Add a simple log message to the `startup_event` in `main.py` (e.g., `logging.getLogger(__name__).info("API starting up...")`).
    *   Run the server and verify that the console output is in the new JSON format.

## 4. Implementation Requirements

- All logs produced by the application should be in a consistent JSON format.
- The configuration should be easy to modify (e.g., to change the log level from `INFO` to `DEBUG`).
- The solution should be compatible with Uvicorn's logging system.

## 5. Success Criteria and Validation

- The new and modified files are created correctly.
- When the API server is run, all console output is formatted as JSON strings.

## 6. Feedback Requirements

Create a detailed Markdown feedback file at:
`[PROJECT_ROOT]/roadmap/_active_prompts/feedback/YYYY-MM-DD-HHMMSS-feedback-05-implement-structured-logging.md`

Include:
-   **Execution Status:** [COMPLETE_SUCCESS | PARTIAL_SUCCESS | FAILED]
-   **Links to Artifacts:** Links to the new/modified files.
-   **Example Log Output:** A few lines of the new JSON log output to demonstrate the result.
>>>>>>> task/implement-structured-logging-20250624-193334
